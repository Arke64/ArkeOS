OFFSET 0x00
CONST 0x000000444556494E
MOV 0x500 RSP
MOV (RIP + 0d5) S
ADD $DISTANCETO(SetupInterrupts) RIP RIP
MOV (RIP + 0d5) S
ADD $DISTANCETO(Add) RIP RIP
BRK
MOV (RIP + 0d5) S
ADD $DISTANCETO(AddressingTest) RIP RIP
BRK
HLT

LABEL Add
MOV 0d10 R0
LABEL AddStart
ADD R0 R1 R1
SUB 0d1 R0 R0
MVNZ R0 ({AddStart} + RBASE) RIP
MOV S RIP

LABEL AddressingTest
MOV 0d8 R0
MOV 0d3 R1
MOV 0d2 R2
MOV 0xDEADBEEF [0d15]
MOV 0xFACEBEEF R5
MOV [(R0 + R1 * R2 + 0d1)] R4
MOV R5 [(R0 + R1 * R2 + 0d1)]
MOV [(R0 + R1 * R2 + 0d1)] R6
MOV 0d1 S
MOV 0d2 S
ADD S S S
MOV S R7
MOV S RIP

LABEL SetupInterrupts
MOV ({SystemTimer} + RBASE) [0x30000000000003]
MOV ({DeviceWaiting} + RBASE) [0x30000000000004]
MOV S RIP

LABEL SystemTimer
ADD 0d1 R8 R8
EINT

LABEL DeviceWaiting
ADD 0d1 R15 R15
MOV RINT2 [(0x50000000000000 + R15)]
EINT